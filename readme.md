# 🤖 多机器人定位与控制系统

本项目是一个**简单、实用、高效**的多机器人控制平台，支持 **NRF24L01 + TTL 串口通信**，结合 **ArUco 标签实时识别与定位**，并通过**模型控制接口**实现机器人集体行为建模与路径规划。

---

## 🎬 功能演示（GIF 实时预览）

| 单机控制 | 多点定位 | 模型控制（方形轨迹） |
|:--------:|:--------:|:--------------------:|
| ![](gif/A_demonstration_of_a_single_machine.gif) | ![](gif/locate-multiple-points.gif) | ![](gif/model-control.gif) |


---

## 🧩 功能亮点

- 📍 **多点定位**：识别多个 ArUco 标签并实时获取其坐标。
- 🖼️ **可视化追踪**：显示机器人路径、当前位置与目标点。
- 🧠 **模型控制接口**：可接入自定义模型（如路径规划、队形控制等）。
- 📡 **NRF24L01通信**：通过 NRF24L01 模块无线发送角度+速度数据包。
- 🖱️ **支持两种模式**：
  - 自定义点击目标（鼠标模式）
  - 自动行为控制（模型模式）

---

## 🔌 模型接口规范

你可以通过 `set_model(func)` 方法传入一个控制模型，支持两种返回格式：

### 📥 输入格式（机器人位置信息）：

```python
{
    0: (x0, y0),
    1: (x1, y1),
    ...
}
```

### 📤 输出格式一：直接目标点模式

```python
{
    0: (tx0, ty0),
    1: (tx1, ty1),
    ...
}
```

### 📤 输出格式二：路径点序列（waypoints 模式）

```python
{
    "waypoints": {
        0: [(x1, y1), (x2, y2), ...],
        1: [(x1, y1), (x2, y2), ...]
    }
}
```

- 模式一适合即时目标导航。
- 模式二适合路径规划、轨迹跟踪任务。

---

## 📦 数据包格式（发送至机器人）

串口发送格式为 4 字节二进制数据：

| 字节 | 含义            |
|------|-----------------|
| 0    | 机器人 ID       |
| 1    | 目标角度高 8 位 |
| 2    | 目标角度低 8 位 |
| 3    | 速度（0–255）   |

说明：

- 角度范围为 0°~359°，以“正上方”为 0 度，顺时针方向增加。
- 使用 `math.atan2` 计算方向，并根据机器人通信协议偏移 +270°。

---

## 🛠️ 开发与运行

### 运行环境建议

- Python 3.9+
- OpenCV 4.5+
- PySide6
- pyserial

### 安装依赖

```bash
pip install opencv-python PySide6 pyserial
```

### 启动程序

```bash
python main.py
```

---

## 📜 开源协议

本项目使用 [MIT License](LICENSE) 开源协议，欢迎自由使用、修改和分发。

---

## 🙋 联系与贡献

如有建议、Bug 提交或希望参与开发，欢迎通过 Issues 或 Pull Request 与我们联系！

---

